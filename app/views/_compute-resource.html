<ng-form name="form">
  <fieldset class="form-inline compute-resource">
    <label ng-if="label">{{label}}</label>
    <div class="resource-size" ng-class="{ 'has-error': form.$invalid }">
      <div class="resource-amount">
        <label class="sr-only" ng-attr-for="{{id}}">总计</label>
        <input type="number"
               name="amount"
               ng-attr-id="{{id}}"
               ng-model="input.amount"
               min="0"
               pattern="\d+(\.\d+)?"
               ng-attr-placeholder="{{placeholder}}"
               select-on-focus
               class="form-control"
               ng-attr-aria-describedby="{{description ? id + '-help' : undefined}}">
      </div>
      <div class="resource-unit">
        <label class="sr-only" ng-attr-for="{{id}}-unit">单位</label>
        <ui-select search-enabled="false" ng-model="input.unit" input-id="{{id}}-unit">
          <ui-select-match>{{$select.selected.label}}</ui-select-match>
          <ui-select-choices repeat="option.value as option in units" group-by="groupUnits">
            {{option.label}}
          </ui-select-choices>
        </ui-select>
      </div>
    </div>
    <div ng-if="description" class="help-block" ng-attr-id="{{id}}-help">
      {{description}}
    </div>
    <div ng-if="form.$invalid" class="has-error">
      <div ng-if="form.amount.$error.number" class="help-block">
        必须是一个数字。
      </div>
      <div ng-if="form.amount.$error.min" class="help-block">
        不能是负数。
      </div>
      <div ng-if="form.amount.$error.limitRangeMin" class="help-block">
        不能小于 {{limitRangeMin | usageWithUnits : type}}.
      </div>
      <div ng-if="form.amount.$error.limitRangeMax" class="help-block">
        不能大于 {{limitRangeMax | usageWithUnits : type}}.
      </div>
      <div ng-if="form.amount.$error.limitLargerThanRequest" class="help-block">
        限制不能少于要求 ({{request | usageWithUnits : type}}).
      </div>
      <div ng-if="form.amount.$error.limitWithinRatio" class="help-block">
        <span ng-if="!input.amount && !defaultValue">
          如果设置了请求，则需要限制。 (最大 限制/请求 的比例: {{maxLimitRequestRatio}})
        </span>
        <span ng-if="input.amount || defaultValue">
          限制不能大于 {{maxLimitRequestRatio}} 次请求值。
          (Request: {{request | usageWithUnits : type}},
          <!-- Show default if amount is unset. -->
          限制: {{(input.amount ? (input.amount + input.unit) : defaultValue) | usageWithUnits : type}})
        </span>
      </div>
    </div>
  </fieldset>
</ng-form>
