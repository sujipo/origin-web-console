<p ng-if="!loaded">加载中...</p>

<div ng-if="emptyCatalog && loaded" class="empty-state-message empty-state-full-page">
  <h2 class="text-center">没有镜像或模板。</h2>

  <p class="gutter-top">
    这个项目和<code>openshift</code>共享项目里都没有镜像或模板。 需要一个镜像或模板来添加内容。
  </p>

  <p>
    通过文件添加镜像或模板，可以在 <strong>导入 YAML / JSON</strong> tab页面中使用编辑器, 或者运行以下命令:
    <div><code>oc create -f &lt;filename&gt; -n {{projectName}}</code></div>
  </p>

  <p><a href="{{projectName | projectOverviewURL}}">返回概述</a></p>
</div>

<div ng-show="!emptyCatalog && loaded && !singleCategory">
  <p ng-if="!parentCategory">从web框架、数据库和其他组件中进行选择向项目添加内容。</p>

  <form role="form" class="filter-catalog search-pf has-button">
    <div class="form-group has-clear">
      <!-- Add a hidden label for screen readers. -->
      <div class="search-pf-input-group">
        <label for="search" class="sr-only">按名称或描述过滤</label>
        <input
           ng-model="filter.keyword"
           type="search"
           id="search"
           placeholder="按名称或描述过滤"
           class="search-input form-control"
           autocorrect="off"
           autocapitalize="none"
           spellcheck="false">
         <button
           type="button"
           class="clear"
           aria-hidden="true"
           ng-if="filter.keyword"
           ng-click="filter.keyword = ''">
           <span class="pficon pficon-close"></span>
         </button>
       </div>
    </div>
  </form>

  <div ng-if="allContentHidden" class="empty-state-message text-center h2">
    所有内容都被当前过滤器隐藏。
    <button type="button" class="btn btn-link inline-btn-link" ng-click="filter.keyword = ''">清除所有过滤器</button>
  </div>

  <div ng-if="!filterActive">
    <div ng-repeat="category in categories" ng-if="hasContent[category.id]">
      <h2 class="h3" ng-if="category.label">{{category.label}}</h2>
      <div class="row tile-row" ng-class="{ 'mar-top-xl': !category.label || category.items.length < 2 }">
        <div ng-repeat="item in category.items" ng-if="countByCategory[item.id]" class="col-xxs-12 col-xs-6 col-sm-6 col-md-4">
          <div class="tile tile-click" ng-class="{ 'tile-sans-icon' : !item.iconClass, 'tile-sans-description' : !item.description }">
            <div class="tile-title">
              <div ng-if="item.iconClass || category.iconClassDefault" class="image-icon">
                <span aria-hidden="true" class="{{item.iconClass || category.iconClassDefault}}"></span>
              </div>
              <h3>
                <!-- top-level category item -->
                <a ng-if="!parentCategory" ng-href="project/{{projectName}}/create/category/{{item.id || 'none'}}" class="tile-target">
                  {{item.label}}
                </a>
                <!-- subcategory item -->
                <a ng-if="parentCategory" ng-href="project/{{projectName}}/create/category/{{parentCategory.id}}/{{item.id || 'none'}}" class="tile-target">
                  {{item.label}}
                </a>
              </h3>
              <!-- <span class="tile-item-count badge">{{countByCategory[item.id] || 0}}</span> -->
            </div>
            <p ng-if="item.description">{{item.description}}</p>
          </div>
        </div>
      </div>
    </div>
    <div ng-if="hasItemsNoSubcategory">
      <div class="row row-cards-pf row-cards-pf-flex">
        <catalog-image
          image-stream="builder"
          project="{{projectName}}"
          is-builder="true"
          ng-repeat="builder in buildersNoSubcategory track by (builder | uid)">
        </catalog-image>
        <catalog-template
          template="template"
          project="{{projectName}}"
          ng-repeat="template in templatesNoSubcategory | orderBy : ['metadata.name', 'metadata.namespace'] track by (template | uid)">
        </catalog-template>
      </div>
    </div>
  </div>

  <div ng-if="filterActive">
    <div ng-repeat="category in categories" ng-if="hasContent[category.id]">
      <div ng-repeat="item in category.items" ng-if="countByCategory[item.id]">
        <h2 class="h3">
          <span ng-bind-html="item.label | highlightKeywords : keywords"></span>
          <span class="tile-item-count badge">{{countByCategory[item.id] || 0}}</span>
        </h2>
        <div class="row row-cards-pf row-cards-pf-flex mar-top-xl">
          <catalog-image
            image-stream="builder"
            project="{{projectName}}"
            is-builder="true"
            keywords="keywords"
            ng-repeat="builder in filteredBuildersByCategory[item.id] track by (builder | uid)">
          </catalog-image>
          <catalog-template
            template="template"
            project="{{projectName}}"
            keywords="keywords"
            ng-repeat="template in filteredTemplatesByCategory[item.id] | orderBy : ['metadata.name', 'metadata.namespace'] track by (template | uid)">
          </catalog-template>
        </div><!-- /row-cards-pf -->
      </div>
    </div>
    <div ng-if="countFilteredNoSubcategory">
      <h2 class="h3">
        其它 {{parentCategory.label}}
        <span class="tile-item-count badge">{{countFilteredNoSubcategory}}</span>
      </h2>
      <div class="row row-cards-pf row-cards-pf-flex mar-top-xl">
        <catalog-image
          image-stream="builder"
          project="{{projectName}}"
          is-builder="true"
          keywords="keywords"
          ng-repeat="builder in filteredBuildersNoSubcategory track by (builder | uid)">
        </catalog-image>
        <catalog-template
          template="template"
          project="{{projectName}}"
          keywords="keywords"
          ng-repeat="template in filteredTemplatesNoSubcategory | orderBy : ['metadata.name', 'metadata.namespace'] track by (template | uid)">
        </catalog-template>
      </div>
    </div>
  </div>
</div>

<!-- If there is only one subcategory with items, just show the items. -->
<div ng-if="singleCategory">
  <category-content
      project-name="projectName"
      project-image-streams="projectImageStreams"
      openshift-image-streams="openshiftImageStreams"
      project-templates="projectTemplates"
      openshift-templates="openshiftTemplates"
      category="singleCategory">
  </category-content>
</div>
